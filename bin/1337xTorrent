#! /bin/bash

bold=$(tput bold)

echo "Donwload Torrent without ads "




download()
{


    command=`lynx -dump -listonly https://1337x.to/category-search/$2/"$1"/1/ | awk '{print $2}' | grep ".to/torrent"   `

    query=($command)
    select opt in "${query[@]}"  quit
        do
	    case $opt in
                "quit")
                exit

            esac
        
	
	clear			

    total_size=`lynx -dump  $opt | grep 'Total size' | awk '{print $4}'`
    unity=`lynx -dump  $opt | grep 'Total size' | awk '{print $5}'`
	magnet=`lynx -dump -listonly $opt | awk '{print $2}' | grep magnet`
    query_magnet=($magnet)
			
	echo $kek "Total size: "$kek $total_size $kek $unity
	read -p  "Is this okay? Yes/No:  " okay

	if [ $okay == "Yes"  ] || [ $okay == "yes" ] || [ $okay == "YES" ] || [ $okay == "y" ];then
	    qbittorrent ${query_magnet[0]}& 
	else
	    exit
	fi		
		
		sleep 2
		clear
        exit

    done    


}

download_anyShit()
{


    command=`lynx -dump -listonly https://1337x.to/search/$1/1/ | awk '{print $2}' | grep ".to/torrent"   `

    query=($command)
    select opt in "${query[@]}"  quit
        do

            case $opt in
                "quit")
                    exit

            esac

			clear			

            total_size=`lynx -dump  $opt | grep 'Total size' | awk '{print $4}'`
            unity=`lynx -dump  $opt | grep 'Total size' | awk '{print $5}'`
			magnet=`lynx -dump -listonly $opt | awk '{print $2}' | grep magnet`
           	query_magnet=($magnet)
			
			echo $kek "Total size: "$kek $total_size $kek $unity
			read -p  "Is this okay? Yes/No:  " okay

			if [ $okay == "Yes"  ];then
				qbittorrent ${query_magnet[0]}&
			else
				exit
			fi		

            sleep 2

            exit

        done


}


options()
{
	for i in $@
	do	
		case $i in
			--dump) if [ $# -eq 3 ]; then 
						command=`lynx -dump -listonly https://1337x.to/category-search/$2/$1/1/ | awk '{print $2}' | grep ".to/torrent" >> dump.txt` 
						echo "Dumping links"
						exit
					elif [ $# -eq 2 ]; then 
			 			command=`lynx -dump -listonly https://1337x.to/search/$1/1/ | awk '{print $2}' | grep ".to/torrent" >> dump.txt`   
						echo "Dumping links"  
						exit
					else
						echo "Usage: 1337xTorrent {search query} --dump or 1337xTorrent {category} {search query} --dump "
						exit 
					fi;;

			--help) echo "Usage : "; echo "--dump: Dump a list of the search results."; echo "--help: Show this screen" ; exit;;
		esac
	done
	
		if  [  $# -eq 1  ]; then
			download_anyShit $1
		elif [  $# -eq 2  ]; then
			main_menu $1 $2		 	
		fi
	
	


}


main_menu(){

		

	if [ $1 == "Movies" ]; then
		download $1 $2
	
	elif [ $1 == "TV"  ]; then
		tv="TV"
		download $1 $2
	
	elif [ $1 == "Games"  ]; then
		download $1 $2
	
	elif [ $1 == "Anime" ];then
		anime="Anime"
		download $1 $2

	else
		echo "Example: 1337xtorrent Games Solasta"
		echo "Avaliable options: Games, Movies, TV(for series), Music and Anime"
	fi

}



if [ $# -eq 0  ]; then
	main_menu $1 $2 2> /dev/null
elif [  $# -eq 3  ]; then
	options $1 $2 $3
elif [ $# -eq 1 ]; then
	#download_anyShit $1
	options $1
else
	options $1 $2
fi



